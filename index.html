<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, target-densitydpi=device-dpi">
    <title>Alcatel 7046T · INDUSTRIAL SCANNER</title>
    <!-- INSTASCAN - lightweight, works on Android 5, supports many 1D/2D -->
    <script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
    <!-- No emojis, only text/icons. Industrial WinCE look, high contrast -->
    <style>
        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            user-select: none; 
            margin: 0;
            padding: 0;
        }
        body { 
            background: #000; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            font-family: 'Roboto', 'Droid Sans', 'Segoe UI', Arial, sans-serif; 
            font-weight: 700; 
            margin: 0;
            padding: 0;
        }
        /* Alcatel 7046T exact size 480x854 */
        #device { 
            width: 480px; 
            height: 854px; 
            background: #1a2a3a;  /* industrial dark blue-gray */
            color: #fff; 
            position: relative; 
            overflow: hidden; 
            display: flex; 
            flex-direction: column; 
            box-shadow: 0 0 0 2px #7a7a7a; 
            border: 4px solid #3a4a5a;
        }
        /* WinCE style header - sharp, no gradients */
        #header { 
            width: 100%; 
            height: 38px; 
            background: #0f1a24; 
            border-bottom: 3px solid #ffaa00; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 0 12px; 
            font-size: 16px; 
            color: #ffaa00; 
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        #header span {
            color: #ffaa00;
        }
        #header .right {
            display: flex;
            gap: 16px;
            color: #ffffff;
        }
        #header .right span {
            color: #ffffff;
            font-size: 15px;
        }

        /* SCAN BUTTON - big, tactile */
        #scanButton { 
            width: calc(100% - 24px); 
            height: 60px; 
            background: #2a5a3a; 
            border: 4px solid #0f4a1a; 
            color: #fff; 
            font-size: 28px; 
            font-weight: 700; 
            text-align: center; 
            margin: 12px auto 8px auto; 
            border-radius: 0px; 
            box-shadow: inset 0 -4px 0 #0a3a1a, 0 4px 0 #0a1a0a; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 10px; 
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        #scanButton:active { 
            transform: translateY(2px); 
            box-shadow: inset 0 -2px 0 #0a3a1a, 0 2px 0 #0a1a0a;
        }
        .btn-icon {
            font-size: 28px;
            font-weight: bold;
        }

        /* CAMERA FRAME - industrial window */
        #scanFrame { 
            width: 440px; 
            height: 220px; 
            margin: 4px auto 0 auto; 
            position: relative; 
            display: none; 
            z-index: 3; 
            overflow: hidden; 
            background: #000; 
            border: 4px solid #7a8a9a; 
            box-shadow: inset 0 0 0 2px #000;
        }
        #preview { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            display: block; 
        }

        /* STATIC YELLOW CORNER BRACKETS - industrial targeting */
        .corner-bracket {
            position: absolute;
            width: 36px;
            height: 36px;
            border: 4px solid #ffaa00;
            filter: drop-shadow(0 0 5px #ffaa00);
            pointer-events: none;
            z-index: 10;
        }
        .corner-tl { top: 4px; left: 4px; border-right: none; border-bottom: none; }
        .corner-tr { top: 4px; right: 4px; border-left: none; border-bottom: none; }
        .corner-bl { bottom: 4px; left: 4px; border-right: none; border-top: none; }
        .corner-br { bottom: 4px; right: 4px; border-left: none; border-top: none; }

        /* LABEL BLOCK - monochrome industrial display */
        #labelBlock { 
            display: flex; 
            flex-direction: column; 
            flex: 1; 
            min-height: 0; 
            width: 100%; 
            margin-top: 8px; 
        }
        #labelTitle { 
            height: 36px; 
            background: #1a2f3f; 
            border: 2px solid #5a7a8a; 
            display: flex; 
            align-items: center; 
            padding-left: 16px; 
            margin: 0 12px; 
            font-size: 18px; 
            color: #ffaa00; 
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        #labelBox { 
            width: calc(100% - 24px); 
            min-height: 90px; 
            max-height: 130px; 
            margin: 0 auto; 
            border: 4px solid #5a7a8a; 
            background: #c0d0e0; 
            padding: 8px; 
            font-size: 18px; 
            font-weight: 700; 
            color: #000; 
            overflow-y: auto; 
            word-break: break-all; 
            font-family: 'Courier New', monospace; 
            box-shadow: inset 0 0 0 2px #2a3a4a;
        }
        #labelBox span.scan-entry { 
            display: block; 
            border-bottom: 3px solid #2a4a6a; 
            background: #e0e8f0; 
            padding: 6px 8px; 
            margin: 4px 0; 
            font-weight: 700; 
            color: #000; 
            font-size: 18px;
        }
        #labelBox span.scan-entry:last-child { border-bottom: none; }

        /* MANUAL INPUT BAR - high visibility */
        #manualInputDiv { 
            background: #ffffaa; 
            border: 4px solid #ffaa00; 
            margin: 4px 12px; 
            padding: 8px; 
            font-weight: bold; 
            color: #000; 
            display: none; 
            align-items: center; 
            gap: 12px; 
            font-size: 18px;
        }
        #manualIndicator { 
            background: #ffaa00; 
            color: #000; 
            padding: 4px 12px; 
            font-size: 16px; 
            text-transform: uppercase;
        }
        #manualText { 
            flex: 1; 
            font-family: 'Courier New', monospace; 
            letter-spacing: 1px; 
            color: #0066aa; 
            font-size: 18px;
        }

        /* BUTTON BAR - industrial controls */
        #labelButtons { 
            height: 48px; 
            background: #2a4a5a; 
            display: flex; 
            align-items: center; 
            justify-content: space-around; 
            border: 4px solid #0f2a3a; 
            margin: 8px 12px 0 12px; 
            padding: 0; 
            font-weight: 700; 
            font-size: 20px; 
            color: #fff; 
            text-transform: uppercase;
        }
        #labelButtons span { 
            cursor: pointer; 
            padding: 8px 16px; 
            background: transparent; 
            border-right: 2px solid #5a7a8a;
            flex: 1;
            text-align: center;
        }
        #labelButtons span:last-child { border-right: none; }
        #labelButtons span:active { background: #0f6a2a; }

        /* NAV BAR */
        #navBar { 
            height: 40px; 
            background: #0f1f2a; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            border: 3px solid #5a7a8a; 
            margin: 8px 12px 0 12px; 
            padding: 0 16px; 
            font-weight: 700; 
            font-size: 16px; 
            color: #ffaa00; 
            text-transform: uppercase;
        }
        #navBar button { 
            background: transparent; 
            border: 2px solid #7a9aaf; 
            color: white; 
            font-size: 18px; 
            font-weight: 700; 
            cursor: pointer; 
            padding: 4px 10px; 
        }
        #navBar button:active { background: #4CAF50; }

        /* KEYPAD WRAPPER - industrial key section */
        #keypadWrapper { 
            width: 100%; 
            background: #0f1f2a; 
            border-top: 6px solid #ffaa00; 
            margin-top: auto; 
            flex-shrink: 0; 
        }
        #keyTabs {
            display: flex; 
            gap: 8px; 
            padding: 8px 12px 4px 12px;
        } 
        #keyTabs button { 
            flex: 1; 
            background: #1a3a4a; 
            border: 3px solid #0f2a3a; 
            color: #fff; 
            font-size: 18px; 
            font-weight: 700; 
            padding: 8px 0; 
            cursor: pointer;
            text-transform: uppercase;
        }
        #keyTabs button.active { 
            background: #ffaa00; 
            border-color: #aa5500; 
            color: #000; 
        }
        #keyTabs button:active { background: #5a9aaf; }

        /* Numeric pad - big buttons */
        #numericPad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            padding: 6px 15px 10px 15px;
        }
        #numericPad button {
            background: #1a3a4a;
            border: 3px solid #0f2a3a;
            color: #fff;
            font-size: 28px;
            font-weight: 700;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 0 #0f1a1f;
        }
        #numericPad button:active {
            transform: translateY(2px);
            background: #ffaa00;
            color: #000;
        }
        #numericPad button.backspace {
            background: #3a1a1a;
            font-size: 26px;
        }

        /* QWERTY and SYM pads */
        #qwertyPad, #symbolPad { 
            display: none; 
            padding: 0 8px 12px 8px; 
        }
        .row { 
            display: flex; 
            gap: 6px; 
            margin-bottom: 6px; 
            justify-content: center; 
        }
        .row button { 
            flex: 1; 
            max-width: 40px; 
            background: #1a3a4a; 
            border: 3px solid #0f2a3a; 
            color: #fff; 
            font-size: 20px; 
            font-weight: 700; 
            height: 48px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            box-shadow: 0 3px 0 #0f1a1f;
        }
        .row button:active { 
            transform: translateY(2px); 
            background: #ffaa00; 
            color: #000; 
        }
        .row button.special { 
            background: #2a1a3a; 
            max-width: 60px; 
        }
        .row button.space { 
            flex: 3; 
            max-width: 220px; 
            background: #2a4a5a;
        }

        /* STATUS SCREEN (menu) */
        #statusScreen { 
            display: none; 
            flex-direction: column; 
            position: absolute; 
            top: 38px; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background: #0a1a2ae0; 
            z-index: 100; 
            padding: 20px 16px; 
            gap: 10px; 
            border-top: 6px solid #ffaa00;
        }
        .statusBtn { 
            background: #1a3a4a; 
            border: 4px solid #ffaa00; 
            color: white; 
            font-size: 22px; 
            font-weight: 700; 
            padding: 16px 8px; 
            text-align: center; 
            cursor: pointer; 
            text-transform: uppercase;
        }
        .statusBtn:active { background: #4CAF50; }
        .statusBtn.back { 
            background: #2a1a1a; 
            border-color: #aa5500; 
            margin-top: 25px; 
        }

        /* SUCCESS POPUP - industrial confirmation */
        #successPopup { 
            display: none; 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8); 
            z-index: 1000; 
            align-items: center; 
            justify-content: center; 
        }
        .popup-content { 
            background: #1a3a4a; 
            border: 8px solid #ffaa00; 
            padding: 30px 20px; 
            text-align: center; 
            width: 300px; 
        }
        .checkmark { 
            width: 70px; 
            height: 70px; 
            background: #2a7a2a; 
            font-size: 50px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            margin: 0 auto 15px auto; 
            color: white; 
            border: 4px solid #ffaa00;
        }
        .popup-message { 
            font-size: 28px; 
            font-weight: 700; 
            color: #ffaa00; 
        }
        .eta-info { 
            color: #fff; 
            font-size: 16px; 
            margin-top: 10px; 
            border-top: 2px solid #ffaa00; 
            padding-top: 10px; 
        }
        #errorMessage { 
            color: #ff5555; 
            text-align: center; 
            padding: 10px; 
            font-size: 18px; 
            display: none; 
            background: #000;
            border: 2px solid red;
        }
        /* scrollbar */
        #labelBox::-webkit-scrollbar { width: 6px; } 
        #labelBox::-webkit-scrollbar-thumb { background: #ffaa00; }
    </style>
</head>
<body>
    <div id="device">
        <!-- HEADER - no emojis -->
        <div id="header">
            <span>ALCATEL 7046T</span>
            <div class="right">
                <span>GPS</span>
                <span id="timeDisplay">14:28</span>
            </div>
        </div>

        <!-- SCAN BUTTON (triggers camera) -->
        <div id="scanButton">
            <span class="btn-icon">[+]</span> SCAN <span class="btn-icon">[+]</span>
        </div>

        <!-- CAMERA FRAME -->
        <div id="scanFrame">
            <video id="preview"></video>
            <div class="corner-bracket corner-tl"></div>
            <div class="corner-bracket corner-tr"></div>
            <div class="corner-bracket corner-bl"></div>
            <div class="corner-bracket corner-br"></div>
        </div>

        <!-- LABEL AREA -->
        <div id="labelBlock">
            <div id="labelTitle">SCANNED DATA</div>
            <div id="labelBox"><span class="scan-entry">---</span></div>
            <!-- manual entry indicator -->
            <div id="manualInputDiv">
                <span id="manualIndicator">MANUAL</span>
                <span id="manualText"></span>
            </div>
            <!-- control buttons -->
            <div id="labelButtons">
                <span id="sendBtn">SEND</span>
                <span id="clearBtn">CLEAR</span>
                <span id="flashBtn">FLASH</span>
            </div>
        </div>

        <!-- NAV BAR -->
        <div id="navBar">
            <button id="statusMenuBtn">MENU</button>
            <span>XEON LINK</span>
            <button id="closeSettings">CFG</button>
        </div>

        <!-- KEYPAD SECTION (industrial) -->
        <div id="keypadWrapper">
            <div id="keyTabs">
                <button id="tabQwerty" class="active">QWERTY</button>
                <button id="tabNumeric">123</button>
                <button id="tabSymbol">SYM</button>
            </div>
            <!-- numeric pad -->
            <div id="numericPad">
                <button>1</button><button>2</button><button>3</button>
                <button>4</button><button>5</button><button>6</button>
                <button>7</button><button>8</button><button>9</button>
                <button>.</button><button>0</button><button class="backspace">DEL</button>
            </div>
            <!-- qwerty pad -->
            <div id="qwertyPad">
                <div class="row"><button>Q</button><button>W</button><button>E</button><button>R</button><button>T</button><button>Y</button><button>U</button><button>I</button><button>O</button><button>P</button></div>
                <div class="row"><button>A</button><button>S</button><button>D</button><button>F</button><button>G</button><button>H</button><button>J</button><button>K</button><button>L</button><button class="special">DEL</button></div>
                <div class="row"><button>Z</button><button>X</button><button>C</button><button>V</button><button>B</button><button>N</button><button>M</button><button class="special">ENT</button></div>
                <div class="row"><button class="space">SPACE</button></div>
            </div>
            <!-- symbol pad -->
            <div id="symbolPad">
                <div class="row"><button>!</button><button>@</button><button>#</button><button>$</button><button>%</button><button>^</button><button>&</button><button>*</button><button>(</button><button>)</button></div>
                <div class="row"><button>-</button><button>_</button><button>=</button><button>+</button><button>[</button><button>]</button><button>{</button><button>}</button><button>\</button><button>|</button></div>
                <div class="row"><button>;</button><button>:</button><button>'</button><button>"</button><button>,</button><button>.</button><button>/</button><button>?</button><button class="backspace">DEL</button></div>
                <div class="row"><button class="space">SPACE</button></div>
            </div>
        </div>

        <!-- STATUS MENU (hidden) -->
        <div id="statusScreen">
            <div class="statusBtn">REINIT CAMERA</div>
            <div class="statusBtn">XANO STATUS</div>
            <div class="statusBtn">CLEAR ALL</div>
            <div class="statusBtn back">BACK</div>
        </div>

        <!-- SUCCESS POPUP -->
        <div id="successPopup">
            <div class="popup-content">
                <div class="checkmark">✓</div>
                <div class="popup-message">SENT TO XEON</div>
                <div class="eta-info">XANO 200 OK</div>
            </div>
        </div>
        <div id="errorMessage"></div>
    </div>

    <script>
        (function() {
            // ---------- CONFIG ----------
            const XANO_URL = 'https://x8ki-letl-twmt.n7.xano.io/api:WGx5FQAG/qr_scans';
            
            // UI elements
            const scanBtn = document.getElementById('scanButton');
            const scanFrame = document.getElementById('scanFrame');
            const preview = document.getElementById('preview');
            const labelBox = document.getElementById('labelBox');
            const manualDiv = document.getElementById('manualInputDiv');
            const manualText = document.getElementById('manualText');
            const sendBtn = document.getElementById('sendBtn');
            const clearBtn = document.getElementById('clearBtn');
            const flashBtn = document.getElementById('flashBtn');
            const statusMenuBtn = document.getElementById('statusMenuBtn');
            const statusScreen = document.getElementById('statusScreen');
            const backBtn = document.querySelector('.statusBtn.back');
            const successPopup = document.getElementById('successPopup');
            const errorDiv = document.getElementById('errorMessage');
            
            // Tabs & keypads
            const tabQwerty = document.getElementById('tabQwerty');
            const tabNumeric = document.getElementById('tabNumeric');
            const tabSymbol = document.getElementById('tabSymbol');
            const numericPad = document.getElementById('numericPad');
            const qwertyPad = document.getElementById('qwertyPad');
            const symbolPad = document.getElementById('symbolPad');
            
            // State
            let scanner = null;                // Instascan scanner instance
            let activeCamera = null;
            let torchActive = false;
            let scanEntries = [];
            let currentManual = '';
            let lastScan = '';

            // ---------- helper: update label box ----------
            function updateLabelBox() {
                let html = '';
                if (scanEntries.length === 0) {
                    html = '<span class="scan-entry">---</span>';
                } else {
                    const recent = scanEntries.slice(-3).reverse();
                    recent.forEach(code => {
                        html += `<span class="scan-entry">${code}</span>`;
                    });
                }
                labelBox.innerHTML = html;
                if (scanEntries.length > 0) lastScan = scanEntries[scanEntries.length-1];
                else lastScan = '';
            }

            // ---------- XANO send (industrial) ----------
            async function sendToXeon(value) {
                if (!value || value.trim() === '') {
                    alert('NO DATA');
                    return;
                }
                try {
                    const payload = { 
                        code: value.trim(),
                        device: 'ALCATEL7046T',
                        timestamp: new Date().toISOString()
                    };
                    const resp = await fetch(XANO_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (resp.ok) {
                        successPopup.style.display = 'flex';
                        setTimeout(() => successPopup.style.display = 'none', 1200);
                    } else {
                        const txt = await resp.text();
                        errorDiv.style.display = 'block';
                        errorDiv.innerText = 'ERR ' + resp.status;
                        setTimeout(() => errorDiv.style.display = 'none', 2000);
                    }
                } catch (e) {
                    alert('NETWORK ERROR');
                }
            }

            // ---------- start scanner (Instascan) ----------
            function startScanner() {
                if (scanner) {
                    scanner.stop();
                }
                // Instascan works on Android 5, no fancy constructors
                scanner = new Instascan.Scanner({ 
                    video: preview,
                    mirror: false,
                    scanPeriod: 3,
                    refractoryPeriod: 5000  // avoid duplicate spam
                });
                
                scanner.addListener('scan', function(content) {
                    if (content && content.length > 0) {
                        // add to list
                        if (scanEntries.length === 0 || scanEntries[scanEntries.length-1] !== content) {
                            scanEntries.push(content);
                            if (scanEntries.length > 5) scanEntries.shift();
                            updateLabelBox();
                        }
                    }
                });

                // request camera
                Instascan.Camera.getCameras().then(function(cameras) {
                    if (cameras.length > 0) {
                        // find rear camera
                        const rear = cameras.find(c => c.name.toLowerCase().includes('back') || c.name.toLowerCase().includes('rear'));
                        activeCamera = rear || cameras[0];
                        scanner.start(activeCamera);
                        scanFrame.style.display = 'block';
                        errorDiv.style.display = 'none';
                    } else {
                        errorDiv.style.display = 'block';
                        errorDiv.innerText = 'NO CAMERA';
                    }
                }).catch(function(e) {
                    errorDiv.style.display = 'block';
                    errorDiv.innerText = 'CAMERA ERROR';
                });
            }

            // ---------- flash (torch) ----------
            function toggleFlash() {
                if (!scanner || !activeCamera) {
                    alert('START SCANNER FIRST');
                    return;
                }
                // Instascan doesn't have direct flash, but we can try via video track
                const videoTrack = preview.srcObject?.getVideoTracks()[0];
                if (videoTrack && videoTrack.applyConstraints) {
                    torchActive = !torchActive;
                    videoTrack.applyConstraints({ advanced: [{ torch: torchActive }] }).catch(()=>{
                        // fallback
                        videoTrack.applyConstraints({ torch: torchActive }).catch(()=>{
                            alert('FLASH NOT SUPPORTED');
                            torchActive = false;
                        });
                    });
                    flashBtn.innerText = torchActive ? 'FLASH ON' : 'FLASH';
                } else {
                    alert('NO FLASH CONTROL');
                }
            }

            // ---------- manual keypad ----------
            function handleKeyInput(key) {
                if (key === 'DEL') {
                    currentManual = currentManual.slice(0, -1);
                } else if (key === 'ENT' || key === 'SPACE') {
                    currentManual += ' ';
                } else {
                    currentManual += key;
                }
                manualText.innerText = currentManual || ' ';
                manualDiv.style.display = 'flex';
            }

            // ---------- attach keypad listeners ----------
            function attachKeypad(container) {
                container.addEventListener('click', (e) => {
                    if (e.target.tagName === 'BUTTON') {
                        handleKeyInput(e.target.innerText);
                    }
                });
            }
            attachKeypad(numericPad);
            attachKeypad(qwertyPad);
            attachKeypad(symbolPad);

            // ---------- UI event listeners ----------
            scanBtn.addEventListener('click', startScanner);

            sendBtn.addEventListener('click', ()=>{
                let out = lastScan || currentManual;
                if (!out || out === '') {
                    alert('NO DATA');
                    return;
                }
                sendToXeon(out);
            });

            clearBtn.addEventListener('click', ()=>{
                scanEntries = [];
                currentManual = '';
                manualText.innerText = '';
                manualDiv.style.display = 'none';
                updateLabelBox();
            });

            flashBtn.addEventListener('click', toggleFlash);

            statusMenuBtn.addEventListener('click', ()=>{
                statusScreen.style.display = 'flex';
            });

            backBtn.addEventListener('click', ()=>{
                statusScreen.style.display = 'none';
            });

            document.querySelectorAll('.statusBtn')[0].addEventListener('click', ()=>{
                if (scanner) scanner.stop();
                startScanner();
                statusScreen.style.display = 'none';
            });

            document.querySelectorAll('.statusBtn')[2].addEventListener('click', ()=>{
                scanEntries = [];
                currentManual = '';
                manualText.innerText = '';
                manualDiv.style.display = 'none';
                updateLabelBox();
                statusScreen.style.display = 'none';
            });

            // tabs
            tabQwerty.addEventListener('click', ()=>{
                tabQwerty.classList.add('active');
                tabNumeric.classList.remove('active');
                tabSymbol.classList.remove('active');
                qwertyPad.style.display = 'block';
                numericPad.style.display = 'none';
                symbolPad.style.display = 'none';
            });
            tabNumeric.addEventListener('click', ()=>{
                tabNumeric.classList.add('active');
                tabQwerty.classList.remove('active');
                tabSymbol.classList.remove('active');
                numericPad.style.display = 'grid';
                qwertyPad.style.display = 'none';
                symbolPad.style.display = 'none';
            });
            tabSymbol.addEventListener('click', ()=>{
                tabSymbol.classList.add('active');
                tabQwerty.classList.remove('active');
                tabNumeric.classList.remove('active');
                symbolPad.style.display = 'block';
                numericPad.style.display = 'none';
                qwertyPad.style.display = 'none';
            });

            // time
            function updateTime() {
                const d = new Date();
                document.getElementById('timeDisplay').innerText = 
                    d.getHours().toString().padStart(2,'0') + ':' + 
                    d.getMinutes().toString().padStart(2,'0');
            }
            setInterval(updateTime, 1000);
            updateTime();

            // close popup on click
            successPopup.addEventListener('click', ()=> successPopup.style.display = 'none');
            
            // stop scanner on page exit
            window.addEventListener('beforeunload', ()=>{
                if (scanner) scanner.stop();
            });
        })();
    </script>
</body>
</html>
